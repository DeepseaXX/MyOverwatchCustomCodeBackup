//装弹+跳，显示附近30米物体数量和光效
//装弹+跳+下蹲，删除特效

变量
{
	玩家:
		32: ThisCountPoint
		33: CountPoint
		34: CountHUD
		35: CountHUDPosition
}

规则("[count] Count nearby")
{
	事件
	{
		持续 - 每名玩家;
		双方;
		全部;
	}

	条件
	{
		已重生(事件玩家) == 真;
		按钮被按下(事件玩家, 按钮(近身攻击)) == 假;
		按钮被按下(事件玩家, 按钮(装填)) == 真;
		按钮被按下(事件玩家, 按钮(蹲下)) == 假;
		按钮被按下(事件玩家, 按钮(技能2)) == 假;
		按钮被按下(事件玩家, 按钮(跳跃)) == 真;
		按钮被按下(事件玩家, 按钮(互动)) == 假;
	}

	
	动作
	{

		事件玩家.CountHUDPosition = 所选位置(事件玩家);
		消除效果(事件玩家.CountHUD);
		创建效果(事件玩家, 球体, 颜色(灰绿色), 事件玩家.CountHUDPosition, 30, 可见，位置和半径);
		事件玩家.CountHUD = 最后创建的实体;
		事件玩家.ThisCountPoint = 1;
		事件玩家.CountPoint=0;
		While(事件玩家.ThisCountPoint > 0 && 事件玩家.ThisCountPoint <= 数量(全局.A));
			If(事件玩家.F[事件玩家.ThisCountPoint] != 真 && 全局.A[事件玩家.ThisCountPoint] != 0);
				If(相距距离(事件玩家, 全局.A[事件玩家.ThisCountPoint])<30);
					事件玩家.CountPoint=事件玩家.CountPoint+1;
				End;
			End;
				事件玩家.ThisCountPoint = 事件玩家.ThisCountPoint + 1;
		End;
	}
}


规则("[count] HUD")
{
	事件
	{
		持续 - 每名玩家;
		双方;
		全部;
	}

	条件
	{
		已重生(事件玩家) == 真;
	}

	动作
	{
		创建HUD文本(所有玩家(所有队伍), 空, 空, 字符串("{0} {1} {2}", 自定义字符串("【装填+跳跃→显示30米内物品数量】"),  自定义字符串("\n【装填+跳跃+下蹲→删除特效】\n附近物品数量："), 事件玩家.CountPoint), 右边, 0, 颜色(白色), 颜色(白色), 颜色(青绿色), 可见和字符串, 默认可见度);
	}
}

规则("[count] Delete Effect")
{
	事件
	{
		持续 - 每名玩家;
		双方;
		全部;
	}

	条件
	{
		已重生(事件玩家) == 真;
		按钮被按下(事件玩家, 按钮(近身攻击)) == 假;
		按钮被按下(事件玩家, 按钮(装填)) == 真;
		按钮被按下(事件玩家, 按钮(蹲下)) == 真;
		按钮被按下(事件玩家, 按钮(技能2)) == 假;
		按钮被按下(事件玩家, 按钮(跳跃)) == 真;
		按钮被按下(事件玩家, 按钮(互动)) == 假;
	}

	动作
	{
		消除效果(事件玩家.CountHUD);
	}
}